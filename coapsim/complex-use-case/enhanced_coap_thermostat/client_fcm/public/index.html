<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/favicon.ico" />
    <title>FCM Mobile App</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.9.0/firebase-app.js';
        import { getMessaging, getToken, onMessage } from 'https://www.gstatic.com/firebasejs/11.9.0/firebase-messaging.js';
        
        window.firebaseApp = { initializeApp };
        window.firebaseMessaging = { getMessaging, getToken, onMessage };
    </script>
    <link rel="stylesheet" href="#styles">
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    
</head>
<body class="gradient-bg min-h-screen">
    <!-- Notification Container -->
    <div id="notificationContainer" class="fixed top-4 right-4 z-50 w-80 max-w-[calc(100vw-2rem)]">
    </div>

    <!-- Main App Container -->
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="glass p-4 m-4 rounded-2xl">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
                    <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2L3 7v11a1 1 0 001 1h12a1 1 0 001-1V7l-7-5z"/>
                        <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-white text-xl font-bold">FCM Mobile App</h1>
                    <p class="text-white/70 text-sm">Push Notification Service</p>
                </div>
            </div>
        </header>

        <!-- Status Card -->
        <div class="flex-1 p-4">
            <div class="glass rounded-2xl p-6 mb-6">
                <div class="flex items-center space-x-3 mb-4">
                    <div id="statusIndicator" class="w-3 h-3 bg-gray-400 rounded-full"></div>
                    <span id="statusText" class="text-white font-medium">Not Connected - Please Save Profile First</span>
                </div>
                
                <div class="text-white/70 text-sm">
                    <p id="tokenStatus">Waiting for profile setup...</p>
                    <p id="registrationStatus">Complete your profile to connect</p>
                </div>
            </div>

            <!-- User Profile Card -->
            <div class="glass rounded-2xl p-6 mb-6 collapsible-card" data-card="profile">
                <div class="flex items-center justify-between mb-4 cursor-pointer card-header" onclick="toggleCard('profile')">
                    <h3 class="text-white font-semibold flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                        </svg>
                        User Profile
                        <span id="profileRequiredIndicator" class="ml-2 text-red-300 text-sm">(Required to connect)</span>
                    </h3>
                    <svg class="w-5 h-5 text-white/70 transition-transform duration-200 card-chevron" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </div>
                
                <div class="card-content">
                    <div class="space-y-4">
                        <div>
                            <label for="username" class="block text-white/70 text-sm mb-2">Username *</label>
                            <input 
                                type="text" 
                                id="username" 
                                name="username"
                                placeholder="Enter your username (e.g., John Smith)"
                                value=""
                                class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 focus:bg-white/20"
                                maxlength="30"
                                required
                            >
                            <p class="text-white/50 text-xs mt-1">This will be displayed to admins</p>
                        </div>
                        <div>
                            <label for="userEmail" class="block text-white/70 text-sm mb-2">Email (Optional)</label>
                            <input 
                                type="email" 
                                id="userEmail" 
                                name="userEmail"
                                placeholder="Enter your email (e.g., john@example.com)"
                                value=""
                                class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-white/30 focus:bg-white/20"
                            >
                            <p class="text-white/50 text-xs mt-1">For administrative contact purposes</p>
                        </div>
                        <div>
                            <label for="userId" class="block text-white/70 text-sm mb-2">User ID</label>
                            <input 
                                type="text" 
                                id="userId" 
                                name="userId"
                                readonly
                                class="w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white/70 text-sm cursor-not-allowed"
                                placeholder="Auto-generated unique ID"
                            >
                            <p class="text-white/50 text-xs mt-1">Unique identifier (read-only)</p>
                        </div>
                        <div class="flex space-x-3">
                            <button 
                                id="updateProfileBtn" 
                                type="button"
                                class="flex-1 bg-blue-500/30 hover:bg-blue-500/40 text-white font-medium py-2 px-4 rounded-lg transition-all duration-200 border border-blue-500/50 focus:outline-none focus:ring-2 focus:ring-blue-400/50"
                            >
                                Save Profile & Connect
                            </button>
                            <button 
                                id="clearProfileBtn" 
                                type="button"
                                class="px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-white rounded-lg transition-all duration-200 border border-red-500/30"
                                title="Clear all profile data"
                            >
                                Clear
                            </button>
                        </div>
                        <div id="profileStatus" class="text-center text-white/70 text-sm hidden">
                            Profile saved successfully!
                        </div>
                    </div>
                </div>
            </div>

            <!-- Connection Controls -->
            <div id="connectionControls" class="glass rounded-2xl p-6 mb-6 hidden collapsible-card" data-card="connection">
                <div class="flex items-center justify-between mb-4 cursor-pointer card-header" onclick="toggleCard('connection')">
                    <h3 class="text-white font-semibold flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        Connection
                    </h3>
                    <svg class="w-5 h-5 text-white/70 transition-transform duration-200 card-chevron" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </div>
                
                <div class="card-content">
                    <div class="flex space-x-3">
                        <button 
                            id="connectBtn" 
                            type="button"
                            class="flex-1 bg-green-500/30 hover:bg-green-500/40 text-white font-medium py-2 px-4 rounded-lg transition-all duration-200 border border-green-500/50 focus:outline-none focus:ring-2 focus:ring-green-400/50"
                        >
                            Connect to Server
                        </button>
                        <button 
                            id="disconnectBtn" 
                            type="button"
                            class="flex-1 bg-red-500/30 hover:bg-red-500/40 text-white font-medium py-2 px-4 rounded-lg transition-all duration-200 border border-red-500/50 focus:outline-none focus:ring-2 focus:ring-red-400/50 hidden"
                        >
                            Disconnect
                        </button>
                    </div>
                </div>
            </div>

            <!-- Notification History Panel -->
            <div class="glass rounded-2xl p-6 mb-6 collapsible-card" data-card="history">
                <div class="flex items-center justify-between mb-4 cursor-pointer card-header" onclick="toggleCard('history')">
                    <h3 class="text-white font-semibold flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                        </svg>
                        Notification History
                    </h3>
                    <div class="flex items-center space-x-2">
                        <button 
                            id="clearHistoryBtn" 
                            type="button"
                            class="px-3 py-1 bg-red-500/20 hover:bg-red-500/30 text-white text-sm rounded-lg transition-all duration-200 border border-red-500/30"
                            title="Clear all notification history"
                            onclick="event.stopPropagation()"
                        >
                            Clear All
                        </button>
                        <svg class="w-5 h-5 text-white/70 transition-transform duration-200 card-chevron" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                </div>
                
                <div class="card-content">
                    <div id="notificationHistory" class="space-y-3 max-h-64 overflow-y-auto">
                        <div class="text-white/50 text-sm text-center py-4">
                            No notifications received yet
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Card -->
            <div class="glass rounded-2xl p-6 mb-6 collapsible-card" data-card="settings">
                <div class="flex items-center justify-between mb-4 cursor-pointer card-header" onclick="toggleCard('settings')">
                    <h3 class="text-white font-semibold flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                        </svg>
                        Settings
                    </h3>
                    <svg class="w-5 h-5 text-white/70 transition-transform duration-200 card-chevron" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </div>
                
                <div class="card-content">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-white/70 text-sm mb-2">Notification Display Time</label>
                            <div class="flex items-center space-x-3">
                                <input 
                                    type="range" 
                                    id="durationSlider" 
                                    min="1" 
                                    max="15" 
                                    value="5" 
                                    class="flex-1 h-2 bg-white/20 rounded-lg appearance-none cursor-pointer"
                                >
                                <span id="durationValue" class="text-white font-medium min-w-[3rem]">5s</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Card -->
            <div class="glass rounded-2xl p-6 collapsible-card" data-card="stats">
                <div class="flex items-center justify-between mb-4 cursor-pointer card-header" onclick="toggleCard('stats')">
                    <h3 class="text-white font-semibold flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                        </svg>
                        Statistics
                    </h3>
                    <svg class="w-5 h-5 text-white/70 transition-transform duration-200 card-chevron" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </div>
                
                <div class="card-content">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <div id="totalNotifications" class="text-2xl font-bold text-white">0</div>
                            <div class="text-white/70 text-sm">Total Received</div>
                        </div>
                        <div class="text-center">
                            <div id="lastReceived" class="text-2xl font-bold text-white">--</div>
                            <div class="text-white/70 text-sm">Last Received</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="env.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>